# MidCheckPassport
### Описание проекта
Мини-проект `MidCheckPassport` предназначен для автоматической проверки статуса заявления на получение загранпаспорта через сайт Министерства иностранных дел https://info.midpass.ru/

При изменении статуса заявления, программа автоматически отправляет уведомление в указанный Telegram чат.

## EXE-файл в релизе
Для удобства использования, в разделе релизов этого репозитория вы можете найти скомпилированный EXE-файл программы. Этот файл не требует установки Python или дополнительных библиотек, и может быть запущен напрямую на вашем компьютере с операционной системой Windows.
#### Использование EXE-файла
1. [Загрузите EXE-файл из последнего релиза](https://github.com/yomoe/MidCheckPassport/releases/).
2. Разместите файл .env в той же папке, где находится EXE-файл.
3. Запустите EXE-файл.

При первом запуске программа создаст BAT-файлы для добавления и удаления задач в планировщике задач Windows, которые также будут находиться в этой же папке. Вы можете использовать эти файлы для автоматического запуска проверки.

[Информация на сайте МИД обновляется раз в сутки](https://info.midpass.ru/): `Внимание! Информационный портал обновляется один раз в сутки. В случае острой необходимости более актуальные сведения о готовности загранпаспорта нового поколения Вы можете получить, обратившись в консульское учреждение, принявшее у Вас заявление о его выдаче.`.

Время обновления мне не известно, то задачи для планировщика установлены на 9:00 и 21:00.

### Особенности
* Автоматическая проверка статуса заявления.
* Уведомления о смене статуса в Telegram.
* Возможность запланировать автоматический запуск программы через планировщик задач Windows.

### Требования
* Python 3.11.x
* Установленные Python-библиотеки из `requirements.txt`

### Установка и запуск
1. Клонировать репозиторий:
```
git clone https://github.com/yomoe/MidCheckPassport.git
```
2. Создать и активировать виртуальное окружение:
```
python3 -m venv venv
```
```
source venv/bin/activate
```
```
python3 -m pip install --upgrade pip
```
3. Установить необходимые зависимости:
```
pip install -r requirements.txt
```
4. Переименуйте файл .env.dict в .env и откройте его в текстовом редакторе. Заполните необходимые поля:
```
BOT_TOKEN=Ваш_токен_бота
CHAT_ID=ID_вашего_чата
MID_ENDPOINT=https://info.midpass.ru/api/request/
ID_REQUEST=Ваш_номер_заявления
```
5. Запуск программы:
```
python check.py
```

## Создание EXE-файла самостоятельно
Если вы хотите самостоятельно создать исполняемый файл из исходного кода, выполните следующие шаги:
#### Требования:
* Python 3.11.x
* Установленный модуль PyInstaller

#### Шаги:
1. Клонировать репозиторий:
```
git clone https://github.com/yomoe/MidCheckPassport.git
```
2. Перейти в папку проекта:
```
cd MidCheckPassport
```
3. Создать и активировать виртуальное окружение:
```
python3 -m venv venv
```
```
source venv/bin/activate
```
```
python3 -m pip install --upgrade pip
```
4. Установить необходимые зависимости:
```
pip install -r requirements.txt
```
5. Создать EXE-файл с помощью PyInstaller:
```
pyinstaller --onefile --add-data "./venv/Lib/site-packages/fake_useragent/data/browsers.json;fake_useragent/data" check.py
```
После выполнения этих команд, EXE-файл будет находиться в папке dist.

## Проблемы и предложения

Если у вас возникли проблемы при использовании этого проекта или у вас есть предложения по его улучшению, пожалуйста, создайте Issue или Pull Request.
